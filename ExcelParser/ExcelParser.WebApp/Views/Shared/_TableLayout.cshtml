@model List<ExcelParser.Parser.Models.TableRow>
@{
    List<List<ExcelParser.Parser.Models.TableRow>> groupedRows = Model
        .GroupBy(row => row.BankName)
        .Select(group => group.ToList())
        .ToList();
}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>@ViewData["Title"]</title>
    <link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.min.css"/>
    <link rel="stylesheet" href="~/css/site.css" asp-append-version="true"/>
    <link rel="stylesheet" href="~/css/site.css" asp-append-version="true"/>
</head>
<nav style="background-color: #1861ac">
    <a style="color: #0dcaf0" class="navbar-brand" href="#">Web Excel</a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>
</nav>
<body>
<div class="container">
    <a href="@Url.Action("Home","Home",new {filePath=ViewData["filePath"]})"><button  type="button"style="border-radius: 12px" class="btn btn-primary">Главная</button></a>
    <main role="main" class="pb-3">
        <div style="align-content: center">
        </div>
        @RenderBody()
         <div class="row px-xl-5">
             <div class="col-lg-12 table-responsive mb-5">
                 @RenderBody()
                
                        <!-- Группировка записей по банкам -->
                        @{
                            string currentBankName=null;
                        }
                
                 @foreach (var tableRows in groupedRows)
                 {
                         <h3>Id : @tableRows[0].Id</h3>
                         <h3>Банк : @tableRows[0].BankName</h3>
                         <table id="cartTable" class="table table-bordered text-center mb-0">
                             <thead class="bg-secondary text-dark">
                             <tr>
                                 <th>Кредитный продукт</th>
                                 <th>Срок min</th>
                                 <th>Срок max</th>
                                 <th>Период</th>
                                 <th>Ставка min</th>
                                 <th>Ставка max</th>
                                 <th>Примечание</th>
                             </tr>
                             </thead>
                             <tbody class="align-middle">
                             @foreach (var tableRow in tableRows)
                             {
                                 <tr>
                                     <td>@(tableRow.CreditProduct != null ? tableRow.CreditProduct : "")</td>
                                     <td>@(tableRow.TermMin != null ? tableRow.TermMin.ToString() : "")</td>
                                     <td>@(tableRow.TermMax != null ? tableRow.TermMax.ToString() : "")</td>
                                     <td>@(tableRow.Period != null ? tableRow.Period : "")</td>
                                     <td>@(tableRow.RateMin != null ? tableRow.RateMin.ValueString : "")</td>
                                     <td>@(tableRow.RateMax != null ? tableRow.RateMax.ValueString : "")</td>
                                     <td>@(tableRow.Note != null ? tableRow.Note : "")</td>
                                 </tr>
                             }

                             </tbody>
                         </table>
                 }
             </div>
            </div>
    </main>
</div>
<script src="~/lib/jquery/dist/jquery.min.js"></script>
<script src="~/lib/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
<script src="~/js/site.js" asp-append-version="true"></script>
@await RenderSectionAsync("Scripts", required: false)
</body>
</html>